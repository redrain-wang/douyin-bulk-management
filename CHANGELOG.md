# 更新日志 (Changelog)

## [1.1.1] - 2024-12-14

### ✨ 新增功能
- **可视化下载队列**：新增实时下载进度 UI，清晰显示每个视频的下载状态
  - 固定在页面右上角
  - 实时更新进度（X/Y）
  - 状态图标区分（⬇️下载中 / ✅成功 / ❌失败）
  - 自动滚动到最新项
  - 完成后 3 秒自动关闭

### 🔧 优化改进
- **智能防限流**：下载间隔从固定 1 秒改为随机 2-4 秒
  - 避免固定频率被识别为机器行为
  - 更接近真实用户操作
  - 显著降低被限流的风险
- **自动重试机制**：遇到 403 错误自动重试 2 次
  - 每次重试间隔 3-5 秒（随机）
  - 适应临时网络波动或限流
- **改进提示信息**：
  - 下载前明确告知间隔时间（2-4 秒）
  - 失败提示增加限流说明和重试建议
  - 更详细的错误日志输出

### 🐛 问题修复
- 修复部分视频返回 403 错误无法下载的问题（通过重试机制）
- 优化下载体验，避免用户感知不到下载进度

### 📝 文档更新
- 新增 `DOWNLOAD_OPTIMIZATION.md`：详细说明防限流机制和使用建议
- 更新使用说明，添加批量下载最佳实践
- 添加 403 错误原因分析和解决方案

---

## [1.1.0] - 2024-12-14

### ✨ 新增功能
- **批量下载视频**：新增批量下载功能，可以一键下载选中的视频到本地
  - 使用视频标题自动命名文件（清理特殊字符）
  - 智能下载队列，避免浏览器并发限制
  - 显示下载进度和结果统计
  - 支持下载失败提示和重试

### 🔧 优化改进
- 缓存结构增加 `download_url` 和 `title` 字段
- 优化下载链接获取逻辑（优先使用 creator.douyin.com 端点）
- UI 按钮布局优化，添加"📥 批量下载"按钮

### 📝 文档更新
- README 添加批量下载功能说明和使用技巧
- 更新功能特性列表
- 添加下载注意事项

---

## [1.0.0] - 2024-12-07

### ✨ 初始发布
- **批量选择**：一键全选当前页面所有视频
- **批量删除**：快速删除多个选中的视频
- **批量权限设置**：
  - 可见性控制（公开/私密/好友）
  - 下载权限控制（允许/禁止下载）
- **智能缓存**：增量加载视频数据，内存优化 99%
- **自动适配**：支持多标签页切换
- **防误操作**：所有批量操作都有二次确认

### 🎨 界面设计
- 简洁的按钮布局
- 视频卡片复选框
- 清晰的操作反馈

### 🛠️ 技术实现
- Manifest V3
- Content Script 注入
- MutationObserver 监听页面变化
- API 增量加载和缓存管理
- 智能参数保护机制
