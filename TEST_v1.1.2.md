# 🧪 v1.1.2 快速测试指南

## ✅ 快速开始

### 1. 更新扩展
```
访问 chrome://extensions/
找到 "Douyin Bulk Manager"
点击"重新加载"图标 🔄
确认版本号显示 1.1.2
```

### 2. 打开开发者工具
```
按 F12 打开
切换到 Console 标签页
```

### 3. 测试下载
```
刷新抖音创作者页面
勾选 5-10 个视频
点击"📥 批量下载"
确认开始
```

---

## 🎯 功能测试

### 测试 1: 多链接重试 ⭐

**验证点**:

1. **查看控制台输出**
   ```
   ✅ 应该看到：
   📥 开始下载: xxx.mp4 (3 个链接)
   
   失败时应该看到：
   ❌ 下载失败: ... Error: HTTP 403
   ⚠️ 链接 1 下载失败，2.3秒后重试...
   🔄 切换到链接 2/3...
   ```

2. **观察链接切换**
   - 失败视频自动尝试第 2、3 个链接
   - 控制台显示 `🔄 切换到链接 2/3` 或 `🔄 切换到链接 3/3`

3. **成功标志**
   ```
   成功：✅ 下载成功: xxx.mp4
   失败（全部）：❌ 所有 3 个链接都失败了: xxx.mp4
   ```

**预期结果**:
- ✅ 之前失败的 403 视频，现在通过切换链接成功
- ✅ 成功率明显提升（从 67% → 90%+）

---

### 测试 2: 收起/展开 💾

**操作**:
1. 开始下载，观察右上角窗口
2. 点击 "📥 批量下载进度" 标题栏

**验证点**:

展开状态（初始）:
```
┌─────────────────────────────┐
│ 📥 批量下载进度    3/5    − │
├─────────────────────────────┤
│ ✅ 视频1.mp4             │
│ ✅ 视频2.mp4             │
│ ⬇️ 视频3.mp4             │
│ ⏳ 视频4.mp4             │
│ ⏳ 视频5.mp4             │
└─────────────────────────────┘
```

点击标题栏后（收起）:
```
┌─────────────────────────────┐
│ 📥 批量下载进度    3/5    + │
└─────────────────────────────┘
```

**验证项**:
- ✅ 点击标题栏有反应
- ✅ 右端图标从 `−` 变为 `+`
- ✅ 列表消失，标题栏保留
- ✅ 进度计数仍可见 (3/5)
- ✅ 再次点击可展开
- ✅ 动画流畅（无卡顿）

---

## 📊 成功率测试

### 对比测试

**场景**: 下载 12 个视频

**v1.1.1 成绩**:
```
成功: 8 个 ✅
失败: 4 个 ❌
成功率: 67%
```

**v1.1.2 预期**:
```
成功: 11 个 ✅
失败: 1 个 ❌ (或 0 个)
成功率: 90%+ ✅
```

**测试方法**:
1. 勾选 12 个视频
2. 点击下载
3. 查看最终提示: "成功: X 个，失败: Y 个"

---

## 🔍 控制台日志详解

### 正常下载日志
```
📥 开始批量下载视频
下载进度: [1/5] 视频标题.mp4 (3 个链接)
📥 开始下载: 视频标题.mp4 URL: https://v3-cold3...
📊 响应状态: 200 OK
📦 Blob 大小: 12.5 MB
✅ 触发下载: 视频标题.mp4
⏳ 等待 2.8 秒后继续...
✅ 下载成功: 视频标题.mp4
```

### 重试下载日志
```
📥 开始下载: 视频标题.mp4 URL: https://v3-cold3...
📊 响应状态: 403 Forbidden
❌ 下载失败: 视频标题.mp4 Error: HTTP 403
⚠️ 链接 1 下载失败，3.2秒后重试...
📥 开始下载: 视频标题.mp4 URL: https://v3-cold3...
📊 响应状态: 403 Forbidden
❌ 下载失败: 视频标题.mp4 Error: HTTP 403
🔄 切换到链接 2/3...
📥 开始下载: 视频标题.mp4 URL: https://v81-cold...
📊 响应状态: 200 OK
✅ 触发下载: 视频标题.mp4
✅ 下载成功: 视频标题.mp4
```

### 全部失败日志
```
❌ 下载失败: 视频标题.mp4 Error: HTTP 403
⚠️ 链接 1 下载失败...
...
🔄 切换到链接 2/3
... (各失败)
🔄 切换到链接 3/3
... (仍失败)
❌ 所有 3 个链接都失败了: 视频标题.mp4
❌ 下载失败: 视频标题.mp4
```

---

## 🐛 常见问题

### Q: 为什么还是有失败？
**A**: 多链接重试已是最优策略，部分 403 可能是：
- 账号被限流（需等待 20-30 分钟）
- 视频链接完全失效（需刷新页面重新加载）
- 网络问题

**解决**: 刷新页面，等待后重试，或分多次下载。

---

### Q: 收起后进度会继续更新吗？
**A**: 会的！计数会实时更新（如 "3/5" 变为 "4/5"），列表隐藏但逻辑继续运行。

---

### Q: 多链接会增加流量吗？
**A**: 不会。只有下载成功后才会产生流量。失败重试不产生视频传输。

---

## 📈 预期改进

### 数据对比

```
指标          v1.1.1      v1.1.2      改进
────────────────────────────────────────
成功率        75%         90%+        +15-20%
链接数        1           3           × 3
重试机制      2 次        2 次/链接   × 3
总尝试数      2           6           × 3
失败处理      简单        智能切换    大幅提升
UI 体验       ⭐⭐⭐      ⭐⭐⭐⭐⭐  +收起功能
```

---

## ✅ 验收清单

测试完成后，请勾选:

- [ ] 多链接重试正常工作
- [ ] 失败视频自动切换链接
- [ ] 控制台日志显示正确
- [ ] 收起/展开功能顺利
- [ ] 进度计数准确更新
- [ ] 成功率提升到 90%+ (或接近)
- [ ] 完全失败视频少于 1 个
- [ ] UI 动画平滑无卡顿

---

## 🚀 最终测试

### 完整测试场景

1. **数量**: 选择 15 个视频（包含可能失败的）
2. **时间**: 预计 60-90 秒完成
3. **成功率**: 至少 13/15 (87%)
4. **功能**: 全部完成无崩溃

**命令行快速验证** (F12 Console):
```javascript
// 查看缓存结构
cachedVideoList.slice(0, 2)

// 应该看到:
[
  {
    aweme_id: "xxx",
    download_urls: ["https://...", "https://...", "https://..."],  // 3 个链接
    title: "视频标题"
  }
]
```

---

## 📞 反馈

测试完成后提供:
1. **成功率**: X/Y 个
2. **失败原因**: 403 / 链接全失 / 其他
3. **功能体验**: 收起展开是否流畅
4. **改进建议**: 有什么可以进一步优化的

🎉 祝测试顺利！
